# MICROROC测试

------

## 信号输入
测试信号有两种输入方式
1. 直接从信号输入管脚输入
   + 使用信号发生源产生一个负的阶跃信号，信号经过$50\Omega$匹配电阻后输入到一个$100pF$电容上，这个$100pF$的电容相当于探测器的输入电容
   + 将电容的两端连接至测试板信号输入管脚，输入电荷信息
   + $1mV$的阶跃信号输入到$100pF$电容上相当于$100fC$电荷注入
   + ![MicrorocAnalogIn1](http://i.imgur.com/FjnHegn.jpg)

2. 使用Ctest管脚输入信号
   + 通过SMA将阶跃电压信号注入芯片
   + 芯片内置有$2pF$电容，在SC参数中选择选通哪一个通道
   + 一次只能够选通一个通道，选通多个通道会造成输入电容增大
   + ![MicrorocAnalogIn2](http://i.imgur.com/Asn9LYQ.jpg)

## 测试方案

### 信号输入
+ 先使用Ctest管脚输入信号，直接将信号发生器信号用SMA注入即可
+ 需要输入一个负的阶跃脉冲，可采用的方案是让信号发生器输出波形为梯形
  ![AFG3252](http://i.imgur.com/0l906UE.jpg)
+ 梯形波的前沿缓慢，防止产生一个正的电流脉冲，利用后沿产生负电流脉冲
+ Ctest管脚最大信号4V，最小信号-0.7V
+ 2mV的信号输入到Ctest管脚上相当于100fC信号
+ 电压和电荷转换关系$Q = - \frac{\DeltaV}{2pF}$

### 阈值电压设置
+ 根据Datasheet，Vth0应当设置为输入信号为2fC时的值，Vth1应当设置为输入信号为20fC时的值，Vth2应当设置为输入信号为200fC的值

+ Vth0、Vth1是High Gain成形输出之后比较器的阈值，Vth2是Low Gain成形电路后面的比较器阈值

+ 信号输出幅度由两方面决定，一是信号输入幅度、二是成形时间，成形时间对输出幅度有微小影响

+ 根据MATLAB计算结果列表如下

  + 2fC

  | sw_hg0 | sw_hg1 | HGSHout | $\tau$ |
  | :----: | :----: | :-----: | :----: |
  |   0    |   0    |  2.177  | 24.80  |
  |   0    |   1    |  2.172  | 91.60  |
  |   1    |   0    |  2.183  | 91.60  |
  |   1    |   1    |  2.178  | 161.70 |

  + 20fC
  | sw_hg0 | sw_hg1 | HGSHout | $\tau$ |
  | :----: | :----: | :-----: | :----: |
  |   0    |   0    |  1.972  | 24.80  |
  |   0    |   1    |  1.919  | 91.60  |
  |   1    |   0    |  2.031  | 91.60  |
  |   1    |   1    |  1.983  | 161.70 |
+ 200fC
  | sw_lg0 | sw_lg1 | LGSHout | $\tau$ |
  | :----: | :----: | :-----: | :----: |
  |   0    |   0    |  2.039  | 55.60  |
  |   0    |   1    |  1.737  | 139.20 |
  |   1    |   0    |  1.854  | 106.70 |
  |   1    |   1    |  1.652  | 163.50 |

